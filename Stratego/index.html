<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Stratego ‚Äì Expert Mode (Hidden Opponent, Reversed Ranks)</title>
<style>
  body {font-family:Arial,Helvetica,sans-serif;background:#111;color:#eee;text-align:center;margin:20px;}
  h1 {margin:10px;color:#ffeb3b;}
  .game-container {max-width:1400px;margin:0 auto;}
  #board {display:grid;grid-template-columns:repeat(10,60px);grid-template-rows:repeat(10,60px);gap:2px;margin:20px auto;width:fit-content;background:#222;padding:8px;border:3px solid #444;border-radius:8px;}
  .cell {width:60px;height:60px;background:#8bc34a;border:2px solid #4caf50;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:bold;cursor:pointer;user-select:none;position:relative;}
  .cell.lake {background:#000;border-color:#111;cursor:default;}
  .red {background:#d32f2f;border-color:#b71c1c;color:white;}
  .blue {background:#1976d2;border-color:#0d47a1;color:white;}
  .piece {width:56px;height:56px;line-height:56px;text-align:center;border-radius:6px;font-size:32px;font-weight:bold;box-shadow:0 3px 6px rgba(0,0,0,0.5);cursor:grab;}
  .selected {box-shadow:0 0 0 4px gold,inset 0 0 10px gold !important;border-color:gold !important;}
  .possible-move {background:#ffeb3b !important;border-color:#f57c00 !important;opacity:0.7;}
  .hidden {filter:brightness(0.5) contrast(0.8);cursor:default;}
  #status {font-size:1.3rem;margin:15px;min-height:1.6em;padding:10px;background:#333;border-radius:6px;}
  .small-label {position:absolute;font-size:10px;bottom:2px;right:4px;opacity:0.75;color:#fff;}
  .graveyard {display:flex;justify-content:space-around;margin:20px 0;gap:20px;}
  .graveyard-section {background:#333;padding:15px;border-radius:8px;border:2px solid #555;min-width:580px;}
  .graveyard-title {font-size:1.2rem;margin-bottom:10px;color:#ffeb3b;}
  .graveyard-row {display:flex;gap:4px;margin-bottom:4px;flex-wrap:wrap;}
  .grave-piece {width:32px;height:32px;line-height:32px;font-size:18px;border-radius:4px;border:1px solid #666;display:flex;align-items:center;justify-content:center;font-weight:bold;}
</style>
</head>
<body>

<h1>Stratego ‚Äì Expert Mode (Hidden Opponent ‚Ä¢ Reversed Ranks ‚Ä¢ Scout Long Moves ‚Ä¢ Graveyard)</h1>
<p><strong>How to play:</strong> Click your piece ‚Üí click destination. Scouts (9) move any distance in a straight line. Opponent‚Äôs pieces are hidden (üõ°Ô∏è).</p>

<div class="game-container">
  <div id="status">üî¥ RED to move ‚Ä¢ Click any of your pieces</div>
  <div id="board"></div>
  
  <div class="graveyard">
    <div class="graveyard-section">
      <div class="graveyard-title">‚ö∞Ô∏è Red Captured</div>
      <div id="red-graveyard" class="graveyard-row"></div>
    </div>
    <div class="graveyard-section">
      <div class="graveyard-title">‚ö∞Ô∏è Blue Captured</div>
      <div id="blue-graveyard" class="graveyard-row"></div>
    </div>
  </div>
</div>

<script>
// Reversed ranks: lower number = stronger (1=Marshal, 9=Scout)
const PIECES = {
  'B': {name:"Bomb",rank:-1,movable:false},
  'F': {name:"Flag",rank:-2,movable:false},
  'S': {name:"Spy",rank:999,movable:true},
  '9': {name:"Scout",rank:9,movable:true,isScout:true},
  '8': {name:"Miner",rank:8,movable:true},
  '7': {name:"Sergeant",rank:7,movable:true},
  '6': {name:"Lieutenant",rank:6,movable:true},
  '5': {name:"Captain",rank:5,movable:true},
  '4': {name:"Major",rank:4,movable:true},
  '3': {name:"Colonel",rank:3,movable:true},
  '2': {name:"General",rank:2,movable:true},
  '1': {name:"Marshal",rank:1,movable:true}
};

const RED_SETUP = ["1","2","3","3","4","4","4","5","5","5","5","6","6","6","6","7","7","7","7","S","B","B","B","B","B","B","F","8","8","8","9","9","9","9","9","9","9","9","8","8"];
const BLUE_SETUP = ["9","9","9","9","9","9","9","9","8","8","B","B","B","B","B","B","F","8","8","8","5","6","6","6","6","7","7","7","7","S","1","2","3","3","4","4","4","5","5","5"];

const board = Array(100).fill(null);
let redGrave = [], blueGrave = [];
let selected = null, currentPlayer = "red", gameOver = false;

function idx(r,c){return r*10+c;}
function isLake(r,c){return (r===4||r===5)&&(c===2||c===3||c===6||c===7);}

function placePieces(){
  let k=0;
  for(let r=0;r<=3;r++) for(let c=0;c<10;c++) if(!isLake(r,c)) board[idx(r,c)]={color:"red",type:RED_SETUP[k++]};
  k=0;
  for(let r=6;r<=9;r++) for(let c=0;c<10;c++) if(!isLake(r,c)) board[idx(r,c)]={color:"blue",type:BLUE_SETUP[k++]};
}

function getPieceHTML(p, visible){
  if(!p) return "";
  let sym = visible ? p.type : "üõ°Ô∏è";
  if(visible){
    if(p.type==='B') sym='üí£';
    if(p.type==='F') sym='‚öë';
    if(p.type==='S') sym='üïµÔ∏è';
  }
  const label = visible ? `<span class="small-label">${p.type}</span>` : "";
  return `<div class="piece ${p.color} ${visible?"":"hidden"}">${sym}${label}</div>`;
}

function getGraveHTML(p){
  let sym = p.type;
  if(p.type==='B') sym='üí£';
  if(p.type==='F') sym='‚öë';
  if(p.type==='S') sym='üïµÔ∏è';
  return `<div class="grave-piece ${p.color}">${sym}</div>`;
}

function render(){
  document.querySelectorAll(".cell").forEach(cell=>{
    const i = Number(cell.dataset.index);
    const p = board[i];
    cell.innerHTML = p ? getPieceHTML(p, p.color===currentPlayer) : "";
    cell.className = "cell" + (isLake(Math.floor(i/10),i%10)?" lake":"");
    if(p) cell.classList.add(p.color);
    if(selected===i) cell.classList.add("selected");
  });
  document.getElementById("red-graveyard").innerHTML = redGrave.map(getGraveHTML).join("");
  document.getElementById("blue-graveyard").innerHTML = blueGrave.map(getGraveHTML).join("");
  document.getElementById("status").textContent = gameOver ? document.getElementById("status").textContent : `${currentPlayer==="red"?"üî¥ RED":"üîµ BLUE"} to move ‚Ä¢ ${selected!==null?"Selected ‚Äì click target":"Click your piece"}`;
}

function isValidScoutPath(from,to){
  const fr=Math.floor(from/10),fc=from%10,tr=Math.floor(to/10),tc=to%10;
  if(fr!==tr && fc!==tc) return false;
  const dr=Math.sign(tr-fr), dc=Math.sign(tc-fc);
  let r=fr+dr, c=fc+dc;
  while(r!==tr || c!==tc){
    if(isLake(r,c) || board[idx(r,c)]) return false;
    r+=dr; c+=dc;
  }
  return true;
}

function isValidMove(from,to){
  if(gameOver || isLake(Math.floor(to/10),to%10)) return false;
  const p=board[from];
  if(!PIECES[p.type].movable) return false;
  const target=board[to];
  if(target && target.color===p.color) return false;
  if(PIECES[p.type].isScout) return isValidScoutPath(from,to);
  return Math.abs(Math.floor(from/10)-Math.floor(to/10)) + Math.abs(from%10-to%10)===1;
}

function showPossible(from){
  document.querySelectorAll(".cell").forEach(cell=>{
    if(isValidMove(from,Number(cell.dataset.index))) cell.classList.add("possible-move");
  });
}

function clearPossible(){document.querySelectorAll(".cell").forEach(c=>c.classList.remove("possible-move"));}

function resolveCombat(a,d){
  const pa=PIECES[a.type], pd=PIECES[d.type];
  if(pa.name==="Miner" && pd.name==="Bomb") return "attacker_wins";
  if(pa.name==="Spy" && pd.name==="Marshal") return "attacker_wins";
  if(pa.rank < pd.rank) return "attacker_wins";   // lower number wins
  if(pa.rank > pd.rank) return "defender_wins";
  return "both_die";
}

function movePiece(from,to){
  if(gameOver) return;
  const att=board[from], def=board[to];
  let winMsg="";

  if(!def){
    board[to]=att; board[from]=null;
  }else{
    const res=resolveCombat(att,def);
    if(res==="attacker_wins"){
      board[to]=att; board[from]=null;
      (def.color==="red"?redGrave:blueGrave).push(def);
      if(def.type==="F"){
        gameOver=true;
        winMsg=`${att.color.toUpperCase()} WINS! Flag captured!`;
      }
    }else if(res==="defender_wins"){
      board[from]=null;
      (att.color==="red"?redGrave:blueGrave).push(att);
    }else{
      board[from]=null; board[to]=null;
      (att.color==="red"?redGrave:blueGrave).push(att);
      (def.color==="red"?redGrave:blueGrave).push(def);
    }
  }

  selected=null;
  clearPossible();
  render();
  if(winMsg) document.getElementById("status").textContent=winMsg;
  else if(!gameOver) currentPlayer = currentPlayer==="red"?"blue":"red";
}

function initBoard(){
  const b=document.getElementById("board");
  b.innerHTML="";
  for(let r=0;r<10;r++){
    for(let c=0;c<10;c++){
      const cell=document.createElement("div");
      cell.className="cell"+(isLake(r,c)?" lake":"");
      cell.dataset.index=idx(r,c);
      cell.addEventListener("click",()=>{
        const i=Number(cell.dataset.index);
        const p=board[i];
        if(selected!==null){
          if(i===selected){
            selected=null; clearPossible();
          }else if(p && p.color===currentPlayer){
            selected=i; clearPossible(); showPossible(i);
          }else if(isValidMove(selected,i)){
            movePiece(selected,i);
          }else{
            selected=null; clearPossible();
          }
        }else if(p && p.color===currentPlayer){
          selected=i; showPossible(i);
        }
        render();
      });
      b.appendChild(cell);
    }
  }
}

function start(){
  board.fill(null); redGrave=[]; blueGrave=[];
  placePieces();
  initBoard();
  render();
}
start();
</script>
</body>
</html>