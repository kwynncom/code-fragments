<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Stratego ‚Äì Reversed Ranks (Fixed Movement)</title>
<style>
  body {
    font-family: Arial, Helvetica, sans-serif;
    background: #111;
    color: #eee;
    text-align: center;
    margin: 20px;
  }
  h1 { margin: 10px; color: #ffeb3b; }

  #board {
    display: grid;
    grid-template-columns: repeat(10, 60px);
    grid-template-rows: repeat(10, 60px);
    gap: 2px;
    margin: 20px auto;
    width: fit-content;
    background: #222;
    padding: 8px;
    border: 3px solid #444;
    border-radius: 8px;
  }

  .cell {
    width: 60px;
    height: 60px;
    background: #8bc34a;
    border: 2px solid #4caf50;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
    position: relative;
  }

  .cell.lake {
    background: #000;
    border-color: #111;
    cursor: default;
  }

  .red    { background: #d32f2f; border-color: #b71c1c; color: white; }
  .blue   { background: #1976d2; border-color: #0d47a1; color: white; }

  .piece {
    width: 56px;
    height: 56px;
    line-height: 56px;
    text-align: center;
    border-radius: 6px;
    font-size: 32px;
    font-weight: bold;
    box-shadow: 0 3px 6px rgba(0,0,0,0.5);
    cursor: grab;
  }

  .selected { 
    box-shadow: 0 0 0 4px gold, inset 0 0 10px gold !important;
    border-color: gold !important;
  }

  #status {
    font-size: 1.3rem;
    margin: 15px;
    min-height: 1.6em;
    padding: 10px;
    background: #333;
    border-radius: 6px;
  }

  .small-label {
    position: absolute;
    font-size: 10px;
    bottom: 2px;
    right: 4px;
    opacity: 0.75;
    color: #fff;
  }
</style>
</head>
<body>

<h1>Stratego ‚Äì Reversed Ranks (9=Scout, 1=Marshal)</h1>
<p><strong>How to play:</strong> 1Ô∏è‚É£ Click YOUR RED piece ‚Üí 2Ô∏è‚É£ Click empty square or enemy ‚Üí Watch it move/attack!</p>

<div id="status">üî¥ RED to move ‚Ä¢ Click your front row pieces (row closest to black lakes)</div>

<div id="board"></div>

<script>
// Piece definitions ‚Äì reversed numbering (lower number = STRONGER)
const PIECES = {
  'B': { name: "Bomb",   rank: -1, movable: false },
  'F': { name: "Flag",   rank: -2, movable: false },
  'S': { name: "Spy",    rank: 999, movable: true }, 
  '9': { name: "Scout",  rank: 9,  movable: true },
  '8': { name: "Miner",  rank: 8,  movable: true },
  '7': { name: "Sergeant", rank: 7, movable: true },
  '6': { name: "Lieutenant", rank: 6, movable: true },
  '5': { name: "Captain", rank: 5, movable: true },
  '4': { name: "Major",   rank: 4, movable: true },
  '3': { name: "Colonel", rank: 3, movable: true },
  '2': { name: "General", rank: 2, movable: true },
  '1': { name: "Marshal", rank: 1, movable: true }
};

const RED_SETUP = [
  "1","2","3","3","4","4","4","5","5","5",
  "5","6","6","6","6","7","7","7","7","S",
  "B","B","B","B","B","B","F","8","8","8",
  "9","9","9","9","9","9","9","9","8","8"
];

const BLUE_SETUP = [
  "9","9","9","9","9","9","9","9","8","8",
  "B","B","B","B","B","B","F","8","8","8",
  "5","6","6","6","6","7","7","7","7","S",
  "1","2","3","3","4","4","4","5","5","5"
];

const board = Array(100).fill(null);
let selected = null;
let currentPlayer = "red";
let gameOver = false;

function idx(r, c) { return r * 10 + c; }

function isLake(r, c) {
  return (r === 4 || r === 5) && (c === 2 || c === 3 || c === 6 || c === 7);
}

function placePieces() {
  let k = 0;
  for (let r = 0; r <= 3; r++) {
    for (let c = 0; c < 10; c++) {
      if (!isLake(r, c)) board[idx(r, c)] = { color: "red", type: RED_SETUP[k++] };
    }
  }
  k = 0;
  for (let r = 6; r <= 9; r++) {
    for (let c = 0; c < 10; c++) {
      if (!isLake(r, c)) board[idx(r, c)] = { color: "blue", type: BLUE_SETUP[k++] };
    }
  }
}

function getPieceHTML(piece) {
  if (!piece) return "";
  let symbol = piece.type;
  if (piece.type === 'B') symbol = 'üí£';
  if (piece.type === 'F') symbol = '‚öë';
  if (piece.type === 'S') symbol = 'üïµÔ∏è';
  return `<div class="piece ${piece.color}">${symbol}<span class="small-label">${piece.type}</span></div>`;
}

function render() {
  document.querySelectorAll('.cell').forEach((cell, idx) => {
    const i = Number(cell.dataset.index);
    const piece = board[i];
    cell.innerHTML = piece ? getPieceHTML(piece) : '';
    cell.className = 'cell' + (isLake(Math.floor(i/10), i%10) ? ' lake' : '');
    if (piece) cell.classList.add(piece.color);
    if (selected === i) cell.classList.add('selected');
  });
  
  const status = document.getElementById('status');
  if (gameOver) {
    status.textContent = status.textContent; // Win message set elsewhere
  } else {
    status.textContent = `${currentPlayer === 'red' ? 'üî¥ RED' : 'üîµ BLUE'} to move ‚Ä¢ ${selected !== null ? '‚úÖ SELECTED - now click target!' : 'Click your piece!'}`
  }
}

function isAdjacent(from, to) {
  const fr = Math.floor(from / 10), fc = from % 10;
  const tr = Math.floor(to / 10), tc = to % 10;
  return Math.abs(fr - tr) + Math.abs(fc - tc) === 1;
}

function isValidMove(from, to) {
  if (gameOver || !isAdjacent(from, to) || isLake(Math.floor(to/10), to%10)) return false;
  
  const piece = board[from];
  if (!PIECES[piece.type]?.movable) return false;
  
  const target = board[to];
  if (!target) return true;
  return target.color !== piece.color;
}

function resolveCombat(attacker, defender) {
  const a = PIECES[attacker.type];
  const d = PIECES[defender.type];

  if (a.name === "Miner" && d.name === "Bomb") return "attacker_wins";
  if (a.name === "Spy" && d.name === "Marshal") return "attacker_wins";

  if (a.rank < d.rank) return "attacker_wins";  // Lower number wins
  if (a.rank > d.rank) return "defender_wins";
  return "both_die";
}

function movePiece(from, to) {
  if (gameOver) return;
  
  const attacker = board[from];
  const defender = board[to];
  
  if (!defender) {
    // Move to empty
    board[to] = attacker;
    board[from] = null;
  } else {
    // Combat
    const result = resolveCombat(attacker, defender);
    if (result === "attacker_wins") {
      board[to] = attacker;
      board[from] = null;
      if (defender.type === 'F') {
        gameOver = true;
        document.getElementById('status').textContent = `${attacker.color.toUpperCase()} WINS! üéâ Flag captured!`;
        return;
      }
    } else if (result === "defender_wins") {
      board[from] = null;
    } else {
      board[from] = null;
      board[to] = null;
    }
  }
  
  currentPlayer = currentPlayer === "red" ? "blue" : "red";
  selected = null;
  render();
}

function initBoard() {
  const boardEl = document.getElementById('board');
  boardEl.innerHTML = '';
  
  for (let r = 0; r < 10; r++) {
    for (let c = 0; c < 10; c++) {
      const cell = document.createElement('div');
      cell.className = 'cell' + (isLake(r, c) ? ' lake' : '');
      cell.dataset.index = idx(r, c);
      
      cell.addEventListener('click', function() {
        const i = Number(this.dataset.index);
        const piece = board[i];
        
        if (selected !== null) {
          if (isValidMove(selected, i)) {
            movePiece(selected, i);
          } else {
            selected = null;
            render();
          }
        } else if (piece && piece.color === currentPlayer) {
          selected = i;
          render();
        }
      });
      
      boardEl.appendChild(cell);
    }
  }
}

function startGame() {
  board.fill(null);
  placePieces();
  initBoard();
  render();
}

startGame();
</script>
</body>
</html>