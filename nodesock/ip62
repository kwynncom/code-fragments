const dns = require('node:dns');

const myf = async (event) => {

    let onfin;
    const thepr = new Promise((resolve) => { onfin = resolve; });
        
    let theres;

    const options = {
    family: 6,
    hints: dns.ADDRCONFIG | dns.V4MAPPED,
    };
    dns.lookup('ipv6.kwynn.com', options, (err, address, family) =>  {
       theres = address;
       if (!theres) theres = 'returned but nothing';
       if (err) theres = err;
       onfin(theres);
    });

    await thepr;

    if (!process.env.AWS_LAMBDA_FUNCTION_NAME) console.log(theres);

    const response = {
        statusCode: 200,
        'Content-Type': 'text/plain',
        body: theres,
    };

    return response;
}

exports.handler = myf;

if (!process.env.AWS_LAMBDA_FUNCTION_NAME) myf();
