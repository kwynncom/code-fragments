<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>JavaScript ping 3</title>

<style>
	body { font-family: monospace; }
	td   { text-align: right; }
</style>
<script src='utils.js' ></script>
<script src='ping10.js'></script>
<script>

	class runningDC {
		
		constructor() {
			const self = this;
			this.bar = [];
			setInterval(function() { self.disp(); }, 170);
		}
		
		reg(stin, e) {
			const o = { 't' : stin, 'e' : e};
			this.bar.unshift(o);
		}
		
		disp() {
			for (let i=0; i < this.bar.length; i++) this.disp20(this.bar[i].t, this.bar[i].e)
		}
		
		
		disp20(stin, e) {
			const d = time() - stin;
			const p = 2;

			const n1 = roundTo(d/ 1000, p);
			const s    = n1.toFixed(p);
			e.innerHTML = s;
		}		
	}

	var KW_G_rdco = new runningDC();
	
	class draw1Ping {
		constructor(tbid) {
			this.tb = byid(tbid);
			this.do10(); 
		}
		
		do10() {
			const tr = cree('tr');
			this.tb.prepend(tr);
			const tdst = cree('td');
			for (let i=0; i < 4; i++) {
				const td = cree('td');
				tr.append(td);
				new do1ping(function(b,e,st) {
					const d = e - b;
					td.innerHTML = d;
					KW_G_rdco.reg(st, tdst);
				}
				);
			}
			tr.append(tdst);
		}
	}


	
</script>


</head>
<body>
	<div>
		<button onclick='new draw1Ping("tb10");	'>ping</button>
	</div>
	<div>
		<table>
			<tbody id='tb10'>
			</tbody>
		</table>
	</div>
	<script>
	window.onload = function() {
		new draw1Ping('tb10');	
	}
	</script>
		
</body>
</html>
